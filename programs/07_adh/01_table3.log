
  ___  ____  ____  ____  ____ (R)
 /__    /   ____/   /   ____/
___/   /   /___/   /   /___/   16.1   Copyright 1985-2019 StataCorp LLC
  Statistics/Data analysis            StataCorp
                                      4905 Lakeway Drive
                                      College Station, Texas 77845 USA
                                      800-STATA-PC        https://www.stata.com
                                      979-696-4600        stata@stata.com
                                      979-696-4601 (fax)

Stata license: 5-user network perpetual
Serial number: 501606316764
  Licensed to: LDI Econ Cornell University
               Ithaca, NY

Notes:
      1. Stata is running in batch mode.
      2. Unicode is supported; see help unicode_advice.

. do 01_table3.do 

. /***********************************
> This regression 
> ***********************************/
.     
. include "../config.do"

. /*  config.do */
. 
. 
. 
. if ( "`c(hostname)'" == "ecco.vrdc.cornell.edu" ) {
. global root "/ssgprojects/project0002/MobZ.new"
. }

. 
. if ( "`c(username)'" == "vilhuber" ) {
. global root "/home/vilhuber/Workspace/git/larsvilhuber/MobZ"
. }

. 
. if ( "`c(hostname)'" == "some.server.at.census" ) {
. global root "/made/up/path/Mobz"
. }

. 
. /* check if the author creates a log file. If not, adjust the following code 
> fragment */
. 
. local c_date = c(current_date)

. local cdate = subinstr("`c_date'", " ", "_", .)

. local c_time = c(current_time)

. local ctime = subinstr("`c_time'", ":", "_", .)

. 
. // log using "${root}/logfile_`cdate'-`ctime'.log", replace text
. 
. /* It will provide some info about how and when the program was run */
. /* See https://www.stata.com/manuals13/pcreturn.pdf#pcreturn */
. local variant = cond(c(MP),"MP",cond(c(SE),"SE",c(flavor)) )  

. // alternatively, you could use 
. // local variant = cond(c(stata_version)>13,c(real_flavor),"NA")  
. 
. di "=== SYSTEM DIAGNOSTICS ==="
=== SYSTEM DIAGNOSTICS ===

. di "Stata version: `c(stata_version)'"
Stata version: 16.1

. di "Updated as of: `c(born_date)'"
Updated as of: 30 Jun 2020

. di "Variant:       `variant'"
Variant:       IC

. di "Processors:    `c(processors)'"
Processors:    1

. di "OS:            `c(os)' `c(osdtl)'"
OS:            Unix 

. di "Machine type:  `c(machine_type)'"
Machine type:  PC (64-bit x86-64)

. di "=========================="
==========================

. 
. 
. 
. 
. /* define relative libraries */
. 
. global paperdir "${root}/paper"

. global interwrk "${root}/data/interwrk"

. global raw "${root}/raw"

. global temp "${root}/temp"

. global outputs "${root}/data"

. global programs "${root}/programs"

. global outgraphs "${root}/figures"

. global logdir "${programs}/logs"

. 
. cap mkdir "$logdir"

. log using "${logdir}/logfile_`cdate'-`ctime'.log", replace text
(note: file /ssgprojects/project0002/MobZ.new/programs/logs/logfile_18_Aug_2020
> -12_32_50.log not found)
-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /ssgprojects/project0002/MobZ.new/programs/logs/logfile_18_Aug_202
> 0-12_32_50.log
  log type:  text
 opened on:  18 Aug 2020, 12:32:50

. cap mkdir "$temp"

. cap mkdir "${root}/data"

. cap mkdir "$interwrk"

. cap mkdir "$raw"

. cap mkdir "$outputs"

. 
. /* install any packages locally */
. capture mkdir "${programs}/ado"

. sysdir set PERSONAL "${programs}/ado/personal"

. sysdir set PLUS     "${programs}/ado/plus"

. sysdir set SITE     "${programs}/ado/site"

. sysdir
   STATA:  /usr/local/stata16/
    BASE:  /usr/local/stata16/ado/base/
    SITE:  /ssgprojects/project0002/MobZ.new/programs/ado/site/
    PLUS:  /ssgprojects/project0002/MobZ.new/programs/ado/plus/
PERSONAL:  /ssgprojects/project0002/MobZ.new/programs/ado/personal/
OLDPLACE:  ~/ado/

. 
. /* define data sources */
. 
. /* QCEW */
. /* data/working/mobz/qcew */
.     global qcewdata "${raw}/qcew"  

. /* /data/working/mobz/outputs */
.     global czonedata "$outputs"  

. 
. /* ADH */
.     global adhdata "${raw}/adh_data/Public Release Data/dta"

. /* CZONE */
.     global czonedata "${raw}/adh_data/"

. /* files provided separately by David Dorn */
.     global dorndata "${raw}/ddorn/"

. 
. /* CBP */
.     /* this is where the raw Stata versions of CBP data reside */
.    global cbpdata "/data/clean/cbp"

. 
. 
. cap log close 

. log using "$logdir/comparison_regressions.log", replace
(note: file /ssgprojects/project0002/MobZ.new/programs/logs/comparison_regressi
> ons.log not found)
-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /ssgprojects/project0002/MobZ.new/programs/logs/comparison_regress
> ions.log
  log type:  text
 opened on:  18 Aug 2020, 12:32:50

. 
. use "$adhdata/workfile_china.dta", clear

. 
. #delimit ; 
delimiter now ;
. keep d_sh_empl_mfg d_tradeusch_pw d_tradeotch_pw_lag 
>                                 timepwt48 czone yr /*t2000*/ statefip;

. rename yr year ;

.  sort czone year ;

. tempfile adh_data;

. save `adh_data', replace ;
(note: file /tmp/St05883.000001 not found)
file /tmp/St05883.000001 saved

. use "$interwrk/finalczdata.dta", clear;

. gen y2000 = year==2000;

.  keep del_L_m* IPW_uit IPW_oit czone year y2000 share_czpop ;

. sort czone year ;

. merge 1:1 czone year using `adh_data';

    Result                           # of obs.
    -----------------------------------------
    not matched                         2,166
        from master                     2,166  (_merge==1)
        from using                          0  (_merge==2)

    matched                             1,444  (_merge==3)
    -----------------------------------------

. tab _merge ;

                 _merge |      Freq.     Percent        Cum.
------------------------+-----------------------------------
        master only (1) |      2,166       60.00       60.00
            matched (3) |      1,444       40.00      100.00
------------------------+-----------------------------------
                  Total |      3,610      100.00

.  /********* just for 1990-2000 *************/
> 
> ivregress 2sls d_sh_empl_mfg (d_tradeusch_pw=d_tradeotch_pw_lag) [aw=timepwt4
> 8] if year==1990, cluster(statefip);
(sum of wgt is   1.0000e+00)

Instrumental variables (2SLS) regression          Number of obs   =        722
                                                  Wald chi2(1)    =      24.00
                                                  Prob > chi2     =     0.0000
                                                  R-squared       =          .
                                                  Root MSE        =     1.7336

                              (Std. Err. adjusted for 48 clusters in statefip)
------------------------------------------------------------------------------
             |               Robust
d_sh_empl_~g |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
d_tradeusc~w |  -.8875124     .18116    -4.90   0.000    -1.242579   -.5324454
       _cons |   -1.05649   .1932492    -5.47   0.000    -1.435252   -.6777288
------------------------------------------------------------------------------
Instrumented:  d_tradeusch_pw
Instruments:   d_tradeotch_pw_lag

.         local beta_1 = _b[d_tradeusch] ;

.         local se_1 = _se[d_tradeusch] ;

.         /*
> ivregress 2sls d_sh_empl_mfg (d_tradeusch_pw=d_tradeotch_pw_lag) [aw=timepwt4
> 8] if year==1990 ;
>         local beta_2 = _b[d_tradeusch] ;
>         local se_2 = _se[d_tradeusch] ;*/
> /************* CHANGING CZ POP WEIGHT ****************/
> /*ivregress 2sls d_sh_empl_mfg (d_tradeusch_pw=d_tradeotch_pw_lag) [aw=share_
> czpop] if year==1990 ;
>         local beta_3 = _b[d_tradeusch] ;
>         local se_3 = _se[d_tradeusch] ;
> */
> /************* CHANGING RHS ****************/
> ivregress 2sls d_sh_empl_mfg (IPW_uit=IPW_oit) [aw=timepwt48] if year==1990, 
> cluster(statefip);
(sum of wgt is   1.0000e+00)

Instrumental variables (2SLS) regression          Number of obs   =        722
                                                  Wald chi2(1)    =      24.00
                                                  Prob > chi2     =     0.0000
                                                  R-squared       =          .
                                                  Root MSE        =     1.7335

                              (Std. Err. adjusted for 48 clusters in statefip)
------------------------------------------------------------------------------
             |               Robust
d_sh_empl_~g |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     IPW_uit |   -.887053   .1810646    -4.90   0.000    -1.241933   -.5321729
       _cons |  -1.056371   .1932329    -5.47   0.000    -1.435101   -.6776416
------------------------------------------------------------------------------
Instrumented:  IPW_uit
Instruments:   IPW_oit

.         local beta_4 = _b[IPW_uit] ;

.         local se_4 = _se[IPW_uit] ;

. /************* CHANGING LHS ****************/
> ivregress 2sls del_L_m (IPW_uit=IPW_oit) [aw=timepwt48] if year==1990, cluste
> r(statefip) ;
(sum of wgt is   1.0000e+00)

Instrumental variables (2SLS) regression          Number of obs   =        722
                                                  Wald chi2(1)    =      28.47
                                                  Prob > chi2     =     0.0000
                                                  R-squared       =          .
                                                  Root MSE        =     1.7704

                              (Std. Err. adjusted for 48 clusters in statefip)
------------------------------------------------------------------------------
             |               Robust
     del_L_m |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     IPW_uit |   -1.00172   .1877542    -5.34   0.000    -1.369711   -.6337283
       _cons |  -1.491791   .2144467    -6.96   0.000    -1.912098   -1.071483
------------------------------------------------------------------------------
Instrumented:  IPW_uit
Instruments:   IPW_oit

.         local beta_5 = _b[IPW_uit] ;

.         local se_5 = _se[IPW_uit] ;

. /************ Changing the weight ************/ 
> ivregress 2sls del_L_mprime (IPW_uit=IPW_oit) [aw=share_czpop] if year==1990,
> cluster(statefip) ;
(sum of wgt is   1.0000e+00)
del_L_mprime is constant and zero
r(459);

end of do-file
r(459);
